<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
        <meta charset="UTF-8">
        <script>setInterval(function() {
    fetch('/test')
      .then(function (response) {
          return response.json();
      }).then(function (text) {
          if(text.changed === "yes"){console.log('query'); location.reload();}
          else {console.log("nonquery");}
      });
}, 1000);</script>
    </head>
    <body style="position: relative; padding: 0%; margin: 0;">
    <div id="particles-js" style="color: white; width: 100%; height:120px; background-size: cover; background-image: url({{ url_for('static',filename ='background.gif') }}); text-align:center; font-size: 40px;">
        <h1 style="position: absolute; padding: 3px; float: left; margin-left:2%; margin-top:10px; font-family: Arial, Helvetica, sans-serif">Welcome to {{ session["user"] }}'s stats page</h1>
    </div>
        <canvas id="myChart" width="600" height="100">
            <script>
            var ctx = document.getElementById('myChart').getContext('2d');
            var ylabel = {{ ylabl }};
            var xlabel = {{ xlabl | tojson }};
            var color = {{ color | tojson }};
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: xlabel,
                    datasets: [{
                        label: 'Hours spent online',
                        data: ylabel,
                        backgroundColor: color,
                        borderColor: color,
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });
            </script>
        </canvas>
        <div style="padding: 5px;">
            <ul style="float: left">
                <li>
                    <h3>You have spent {{ sum }} hours on your computer</h3>
                </li>
                <li>
                    <h3>That is an average of {{ average }} hours per day</h3>
                </li>
            </ul>
            <form action="/" method="post">
                <button name="returnHome" type="submit" style="width: 100px; height: 70px; float: right;">Go Home</button>
            </form>
        </div>
        <script type="text/javascript" src="{{ url_for('static',filename ='particles.js') }}"></script>
       <script type="text/javascript" src="{{ url_for('static',filename ='app.js') }}"></script>
    </body>
</html>